---
/**
 * KeyTakeaways - AEO-optimized summary box
 * 
 * A prominent summary component designed for:
 * - Quick scanning of key points
 * - AEO (Answer Engine Optimization) - helps AI/search extract key info
 * - Case studies, blog posts, guides
 * 
 * Uses semantic HTML and structured data patterns that
 * search engines and AI assistants can easily parse.
 * 
 * @example
 * <KeyTakeaways
 *   title="Key Takeaways"
 *   takeaways={[
 *     'Brand consistency increased user trust by 40%',
 *     'New design system reduced development time by 60%',
 *     'Mobile conversions improved 3x post-redesign',
 *   ]}
 * />
 * 
 * @example With icons
 * <KeyTakeaways
 *   takeaways={[
 *     { text: 'Increased TVL by 340%', icon: 'ðŸ“ˆ' },
 *     { text: '2.5M new users onboarded', icon: 'ðŸ‘¥' },
 *   ]}
 *   variant="cards"
 * />
 */

type Takeaway = string | { text: string; icon?: string };

interface Props {
  /** Array of key takeaways */
  takeaways: Takeaway[];
  /** Section title */
  title?: string;
  /** Visual variant */
  variant?: 'default' | 'numbered' | 'cards' | 'minimal' | 'highlight';
  /** Icon for default variant */
  icon?: 'checkmark' | 'star' | 'arrow' | 'bolt' | 'none';
  /** Accent color */
  accent?: 'pink' | 'cyan' | 'gradient';
}

const {
  takeaways,
  title = 'Key Takeaways',
  variant = 'default',
  icon = 'checkmark',
  accent = 'pink',
} = Astro.props;

// Normalize takeaways to consistent format
const normalizedTakeaways = takeaways.map((t) => 
  typeof t === 'string' ? { text: t } : t
);

// Icon SVGs
const icons = {
  checkmark: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>`,
  star: `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>`,
  arrow: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" /></svg>`,
  bolt: `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>`,
  none: '',
};
---

<aside 
  class:list={[
    'key-takeaways',
    `key-takeaways--${variant}`,
    `key-takeaways--accent-${accent}`,
  ]}
  aria-label="Key takeaways"
  role="complementary"
>
  {/* Header */}
  <div class="takeaways-header">
    <div class="header-icon">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 017 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"/>
      </svg>
    </div>
    <h3 class="takeaways-title">{title}</h3>
  </div>

  {/* Content */}
  <ul class="takeaways-list" role="list">
    {normalizedTakeaways.map((takeaway, index) => (
      <li class="takeaway-item">
        {variant === 'numbered' ? (
          <span class="item-number">{String(index + 1).padStart(2, '0')}</span>
        ) : variant === 'cards' && takeaway.icon ? (
          <span class="item-emoji">{takeaway.icon}</span>
        ) : icon !== 'none' ? (
          <span class="item-icon" set:html={icons[icon]} />
        ) : null}
        <span class="item-text">{takeaway.text}</span>
      </li>
    ))}
  </ul>
</aside>

<style>
  .key-takeaways {
    position: relative;
    margin: 2.5rem 0;
    padding: 2rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 20px;
    overflow: hidden;
  }

  /* Accent colors */
  .key-takeaways--accent-pink {
    border-left: 4px solid var(--neon-pink);
  }

  .key-takeaways--accent-cyan {
    border-left: 4px solid var(--neon-cyan);
  }

  .key-takeaways--accent-gradient {
    border-left: 4px solid transparent;
    border-image: linear-gradient(to bottom, var(--neon-pink), var(--neon-cyan)) 1;
  }

  /* Glow effect */
  .key-takeaways::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 200px;
    height: 100%;
    background: radial-gradient(
      ellipse at left,
      rgba(255, 0, 110, 0.08) 0%,
      transparent 70%
    );
    pointer-events: none;
  }

  .key-takeaways--accent-cyan::before {
    background: radial-gradient(
      ellipse at left,
      rgba(0, 245, 255, 0.08) 0%,
      transparent 70%
    );
  }

  /* Header */
  .takeaways-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
  }

  .header-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    background: var(--gradient-pink);
    border-radius: 10px;
  }

  .key-takeaways--accent-cyan .header-icon {
    background: var(--gradient-cyan);
  }

  .header-icon svg {
    width: 20px;
    height: 20px;
    color: white;
  }

  .takeaways-title {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--white);
    margin: 0;
  }

  /* List */
  .takeaways-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .takeaway-item {
    display: flex;
    align-items: flex-start;
    gap: 0.875rem;
    font-size: 1rem;
    line-height: 1.6;
    color: rgba(255, 255, 255, 0.85);
  }

  /* Icon styles */
  .item-icon {
    flex-shrink: 0;
    width: 20px;
    height: 20px;
    margin-top: 2px;
    color: var(--neon-pink);
  }

  .key-takeaways--accent-cyan .item-icon {
    color: var(--neon-cyan);
  }

  .item-icon :global(svg) {
    width: 100%;
    height: 100%;
  }

  .item-number {
    flex-shrink: 0;
    font-family: var(--font-mono);
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--neon-pink);
    min-width: 28px;
  }

  .item-emoji {
    flex-shrink: 0;
    font-size: 1.25rem;
    line-height: 1;
  }

  .item-text {
    flex: 1;
  }

  /* ========================================
     Variant: Numbered
     ======================================== */
  .key-takeaways--numbered {
    padding: 2.5rem;
  }

  .key-takeaways--numbered .takeaway-item {
    padding-bottom: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.06);
  }

  .key-takeaways--numbered .takeaway-item:last-child {
    padding-bottom: 0;
    border-bottom: none;
  }

  /* ========================================
     Variant: Cards
     ======================================== */
  .key-takeaways--cards {
    background: transparent;
    border: none;
    border-left: none;
    padding: 0;
  }

  .key-takeaways--cards::before {
    display: none;
  }

  .key-takeaways--cards .takeaways-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  }

  .key-takeaways--cards .takeaway-item {
    flex-direction: column;
    gap: 0.75rem;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 16px;
    transition: all 0.3s ease;
  }

  .key-takeaways--cards .takeaway-item:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 0, 110, 0.3);
    transform: translateY(-2px);
  }

  .key-takeaways--cards .item-emoji {
    font-size: 2rem;
  }

  /* ========================================
     Variant: Minimal
     ======================================== */
  .key-takeaways--minimal {
    background: transparent;
    border: none;
    border-left: 3px solid rgba(255, 255, 255, 0.1);
    border-radius: 0;
    padding: 0 0 0 1.5rem;
  }

  .key-takeaways--minimal::before {
    display: none;
  }

  .key-takeaways--minimal .takeaways-header {
    margin-bottom: 1rem;
  }

  .key-takeaways--minimal .header-icon {
    display: none;
  }

  .key-takeaways--minimal .takeaways-title {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    color: rgba(255, 255, 255, 0.5);
  }

  .key-takeaways--minimal .takeaway-item {
    font-size: 0.95rem;
  }

  /* ========================================
     Variant: Highlight
     ======================================== */
  .key-takeaways--highlight {
    background: linear-gradient(
      135deg,
      rgba(255, 0, 110, 0.1) 0%,
      rgba(191, 0, 255, 0.05) 50%,
      rgba(0, 245, 255, 0.1) 100%
    );
    border-color: rgba(255, 0, 110, 0.2);
    padding: 2.5rem;
  }

  .key-takeaways--highlight::before {
    width: 100%;
    height: 100%;
    background: radial-gradient(
      ellipse at 30% 0%,
      rgba(255, 0, 110, 0.1) 0%,
      transparent 50%
    );
  }

  .key-takeaways--highlight .takeaways-title {
    font-size: 1.25rem;
  }

  .key-takeaways--highlight .takeaway-item {
    font-size: 1.0625rem;
  }

  /* ========================================
     Responsive
     ======================================== */
  @media (max-width: 768px) {
    .key-takeaways {
      padding: 1.5rem;
      margin: 2rem 0;
    }

    .key-takeaways--cards .takeaways-list {
      grid-template-columns: 1fr;
    }

    .key-takeaways--highlight {
      padding: 1.5rem;
    }
  }
</style>
