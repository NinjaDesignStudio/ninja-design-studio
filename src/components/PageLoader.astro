---
/**
 * PageLoader - Premium ninja-themed loading animation
 *
 * Features:
 * - High-quality SVG shuriken with gradients and glow
 * - Dynamic status text progression
 * - Smooth particle system
 * - Circular progress with glow trail
 * - Cinematic slice reveal exit
 */
---

<div class="ninja-loader" id="pageLoader" aria-hidden="true">
  <!-- Animated Background -->
  <div class="loader-bg">
    <div class="bg-grid"></div>
    <div class="bg-glow bg-glow-1"></div>
    <div class="bg-glow bg-glow-2"></div>
    <div class="bg-glow bg-glow-3"></div>
    <div class="bg-noise"></div>
  </div>

  <!-- Floating Particles -->
  <div class="particles" id="particles"></div>

  <!-- Main Content -->
  <div class="loader-content">
    <!-- Premium Shuriken -->
    <div class="shuriken-container">
      <!-- Outer glow rings -->
      <div class="glow-ring glow-ring-outer"></div>
      <div class="glow-ring glow-ring-mid"></div>

      <svg class="shuriken" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <!-- Blade gradient -->
          <linearGradient id="bladeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#ffffff" />
            <stop offset="50%" stop-color="#e0e0e0" />
            <stop offset="100%" stop-color="#a0a0a0" />
          </linearGradient>

          <!-- Blade edge gradient -->
          <linearGradient id="bladeEdge" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#ff006e" />
            <stop offset="100%" stop-color="#00f5ff" />
          </linearGradient>

          <!-- Center gradient -->
          <radialGradient id="centerGradient" cx="50%" cy="50%" r="50%">
            <stop offset="0%" stop-color="#2a2a4a" />
            <stop offset="70%" stop-color="#1a1a2e" />
            <stop offset="100%" stop-color="#0a0a15" />
          </radialGradient>

          <!-- Core glow -->
          <radialGradient id="coreGlow" cx="50%" cy="50%" r="50%">
            <stop offset="0%" stop-color="#ff006e" stop-opacity="1" />
            <stop offset="50%" stop-color="#ff006e" stop-opacity="0.5" />
            <stop offset="100%" stop-color="#ff006e" stop-opacity="0" />
          </radialGradient>

          <!-- Progress gradient -->
          <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#ff006e" />
            <stop offset="50%" stop-color="#bf00ff" />
            <stop offset="100%" stop-color="#00f5ff" />
          </linearGradient>

          <!-- Glow filter -->
          <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
            <feMerge>
              <feMergeNode in="coloredBlur"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>

          <!-- Strong glow -->
          <filter id="strongGlow" x="-100%" y="-100%" width="300%" height="300%">
            <feGaussianBlur stdDeviation="8" result="coloredBlur"/>
            <feMerge>
              <feMergeNode in="coloredBlur"/>
              <feMergeNode in="coloredBlur"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>

          <!-- Drop shadow -->
          <filter id="dropShadow" x="-50%" y="-50%" width="200%" height="200%">
            <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.5"/>
          </filter>
        </defs>

        <!-- Background ring -->
        <circle cx="100" cy="100" r="95" stroke="rgba(255,255,255,0.03)" stroke-width="1" fill="none" />

        <!-- Progress track -->
        <circle
          cx="100" cy="100" r="88"
          stroke="rgba(255,255,255,0.05)"
          stroke-width="3"
          fill="none"
        />

        <!-- Progress circle -->
        <circle
          class="progress-circle"
          cx="100" cy="100" r="88"
          stroke="url(#progressGradient)"
          stroke-width="3"
          fill="none"
          stroke-linecap="round"
          stroke-dasharray="553"
          stroke-dashoffset="553"
          id="progressCircle"
          filter="url(#glow)"
        />

        <!-- Shuriken body group -->
        <g class="shuriken-body" filter="url(#dropShadow)">
          <!-- Main blades -->
          <g class="blades">
            <!-- Top blade -->
            <path d="M100 8 L115 75 L100 85 L85 75 Z" fill="url(#bladeGradient)" />
            <path d="M100 8 L108 70 L100 78 L92 70 Z" fill="rgba(255,255,255,0.3)" />
            <path d="M98 20 L100 8 L102 20 L100 70 Z" fill="url(#bladeEdge)" opacity="0.6" />

            <!-- Right blade -->
            <path d="M192 100 L125 115 L115 100 L125 85 Z" fill="url(#bladeGradient)" />
            <path d="M192 100 L130 108 L122 100 L130 92 Z" fill="rgba(255,255,255,0.3)" />
            <path d="M180 98 L192 100 L180 102 L130 100 Z" fill="url(#bladeEdge)" opacity="0.6" />

            <!-- Bottom blade -->
            <path d="M100 192 L85 125 L100 115 L115 125 Z" fill="url(#bladeGradient)" />
            <path d="M100 192 L92 130 L100 122 L108 130 Z" fill="rgba(255,255,255,0.3)" />
            <path d="M102 180 L100 192 L98 180 L100 130 Z" fill="url(#bladeEdge)" opacity="0.6" />

            <!-- Left blade -->
            <path d="M8 100 L75 85 L85 100 L75 115 Z" fill="url(#bladeGradient)" />
            <path d="M8 100 L70 92 L78 100 L70 108 Z" fill="rgba(255,255,255,0.3)" />
            <path d="M20 102 L8 100 L20 98 L70 100 Z" fill="url(#bladeEdge)" opacity="0.6" />
          </g>

          <!-- Inner decorative ring -->
          <circle cx="100" cy="100" r="50" stroke="rgba(255,255,255,0.1)" stroke-width="1" fill="none" />
          <circle cx="100" cy="100" r="45" stroke="rgba(255,255,255,0.05)" stroke-width="0.5" fill="none" />

          <!-- Center mounting plate -->
          <circle cx="100" cy="100" r="25" fill="url(#centerGradient)" stroke="rgba(255,255,255,0.2)" stroke-width="1" />

          <!-- Inner ring detail -->
          <circle cx="100" cy="100" r="18" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5" />

          <!-- Center hole -->
          <circle cx="100" cy="100" r="12" fill="#050508" stroke="rgba(255,255,255,0.15)" stroke-width="1" />
        </g>

        <!-- Core energy (animated) -->
        <g class="core-energy">
          <circle class="core-glow" cx="100" cy="100" r="20" fill="url(#coreGlow)" filter="url(#strongGlow)" />
          <circle class="core-inner" cx="100" cy="100" r="6" fill="#ff006e" filter="url(#glow)" />
        </g>

        <!-- Rotating inner accent -->
        <g class="inner-spin">
          <circle cx="100" cy="70" r="2" fill="#00f5ff" filter="url(#glow)" />
          <circle cx="130" cy="100" r="2" fill="#ff006e" filter="url(#glow)" />
          <circle cx="100" cy="130" r="2" fill="#00f5ff" filter="url(#glow)" />
          <circle cx="70" cy="100" r="2" fill="#ff006e" filter="url(#glow)" />
        </g>
      </svg>

      <!-- Energy rings -->
      <div class="energy-ring energy-ring-1"></div>
      <div class="energy-ring energy-ring-2"></div>
      <div class="energy-ring energy-ring-3"></div>
    </div>

    <!-- Glitch Text -->
    <div class="loader-text">
      <div class="text-ninja" data-text="NINJA">
        <span class="char" style="--i:0">N</span>
        <span class="char" style="--i:1">I</span>
        <span class="char" style="--i:2">N</span>
        <span class="char" style="--i:3">J</span>
        <span class="char" style="--i:4">A</span>
      </div>
      <div class="text-studio">DESIGN STUDIO</div>
    </div>

    <!-- Loading Status -->
    <div class="loader-status">
      <div class="status-line">
        <span class="status-dot"></span>
        <span class="status-text" id="statusText">INITIALIZING</span>
      </div>
      <div class="status-progress">
        <span class="status-percent" id="loaderPercent">0</span>
        <span class="status-symbol">%</span>
      </div>
    </div>
  </div>

  <!-- Slice Reveal Overlay -->
  <div class="slice-reveal">
    <div class="slice slice-1"></div>
    <div class="slice slice-2"></div>
    <div class="slice slice-3"></div>
    <div class="slice slice-4"></div>
    <div class="slice slice-5"></div>
  </div>
</div>

<style>
  .ninja-loader {
    position: fixed;
    inset: 0;
    z-index: 100000;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    background: #030305;
  }

  /* ===== Background Effects ===== */
  .loader-bg {
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  .bg-grid {
    position: absolute;
    inset: -100%;
    background-image:
      linear-gradient(rgba(255, 0, 110, 0.015) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255, 0, 110, 0.015) 1px, transparent 1px);
    background-size: 80px 80px;
    animation: gridMove 30s linear infinite;
    transform: perspective(500px) rotateX(60deg) scale(2);
    transform-origin: center top;
  }

  @keyframes gridMove {
    0% { transform: perspective(500px) rotateX(60deg) scale(2) translateY(0); }
    100% { transform: perspective(500px) rotateX(60deg) scale(2) translateY(80px); }
  }

  .bg-glow {
    position: absolute;
    border-radius: 50%;
    filter: blur(100px);
    opacity: 0.4;
  }

  .bg-glow-1 {
    width: 600px;
    height: 600px;
    background: radial-gradient(circle, rgba(255, 0, 110, 0.3) 0%, transparent 70%);
    top: -200px;
    left: -200px;
    animation: glowFloat 8s ease-in-out infinite;
  }

  .bg-glow-2 {
    width: 500px;
    height: 500px;
    background: radial-gradient(circle, rgba(0, 245, 255, 0.25) 0%, transparent 70%);
    bottom: -150px;
    right: -150px;
    animation: glowFloat 8s ease-in-out infinite reverse;
  }

  .bg-glow-3 {
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(191, 0, 255, 0.2) 0%, transparent 70%);
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: glowPulse 4s ease-in-out infinite;
  }

  @keyframes glowFloat {
    0%, 100% { transform: translate(0, 0) scale(1); }
    50% { transform: translate(30px, 20px) scale(1.1); }
  }

  @keyframes glowPulse {
    0%, 100% { opacity: 0.2; transform: translate(-50%, -50%) scale(0.8); }
    50% { opacity: 0.4; transform: translate(-50%, -50%) scale(1.2); }
  }

  .bg-noise {
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    opacity: 0.03;
    pointer-events: none;
  }

  /* ===== Particles ===== */
  .particles {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .particle {
    position: absolute;
    border-radius: 50%;
    opacity: 0;
    animation: particleRise linear infinite;
  }

  @keyframes particleRise {
    0% {
      opacity: 0;
      transform: translateY(0) scale(0);
    }
    5% {
      opacity: 0.8;
      transform: scale(1);
    }
    95% {
      opacity: 0.6;
    }
    100% {
      opacity: 0;
      transform: translateY(-100vh) scale(0.5);
    }
  }

  /* ===== Loader Content ===== */
  .loader-content {
    position: relative;
    z-index: 10;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2.5rem;
  }

  /* ===== Premium Shuriken ===== */
  .shuriken-container {
    position: relative;
    width: 180px;
    height: 180px;
  }

  .glow-ring {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    pointer-events: none;
  }

  .glow-ring-outer {
    width: 220px;
    height: 220px;
    background: radial-gradient(circle, transparent 40%, rgba(255, 0, 110, 0.1) 50%, transparent 60%);
    animation: ringPulse 3s ease-in-out infinite;
  }

  .glow-ring-mid {
    width: 200px;
    height: 200px;
    background: radial-gradient(circle, transparent 45%, rgba(0, 245, 255, 0.08) 50%, transparent 55%);
    animation: ringPulse 3s ease-in-out infinite 0.5s;
  }

  @keyframes ringPulse {
    0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(1); }
    50% { opacity: 1; transform: translate(-50%, -50%) scale(1.05); }
  }

  .shuriken {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 0 20px rgba(255, 0, 110, 0.3));
  }

  .shuriken-body {
    animation: shurikenSpin 12s linear infinite;
    transform-origin: 100px 100px;
  }

  @keyframes shurikenSpin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .inner-spin {
    animation: innerSpin 6s linear infinite reverse;
    transform-origin: 100px 100px;
  }

  @keyframes innerSpin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .progress-circle {
    transform: rotate(-90deg);
    transform-origin: center;
    transition: stroke-dashoffset 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .core-glow {
    animation: coreGlow 2s ease-in-out infinite;
  }

  @keyframes coreGlow {
    0%, 100% {
      opacity: 0.6;
      transform: scale(1);
    }
    50% {
      opacity: 1;
      transform: scale(1.3);
    }
  }

  .core-inner {
    animation: coreColor 3s ease-in-out infinite;
  }

  @keyframes coreColor {
    0%, 100% { fill: #ff006e; }
    33% { fill: #bf00ff; }
    66% { fill: #00f5ff; }
  }

  /* Energy Rings */
  .energy-ring {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    border: 1px solid transparent;
    opacity: 0;
  }

  .energy-ring-1 {
    width: 180px;
    height: 180px;
    border-color: rgba(255, 0, 110, 0.6);
    box-shadow: 0 0 20px rgba(255, 0, 110, 0.3), inset 0 0 20px rgba(255, 0, 110, 0.1);
    animation: ringExpand 2.5s ease-out infinite;
  }

  .energy-ring-2 {
    width: 180px;
    height: 180px;
    border-color: rgba(0, 245, 255, 0.6);
    box-shadow: 0 0 20px rgba(0, 245, 255, 0.3), inset 0 0 20px rgba(0, 245, 255, 0.1);
    animation: ringExpand 2.5s ease-out infinite 0.8s;
  }

  .energy-ring-3 {
    width: 180px;
    height: 180px;
    border-color: rgba(191, 0, 255, 0.6);
    box-shadow: 0 0 20px rgba(191, 0, 255, 0.3), inset 0 0 20px rgba(191, 0, 255, 0.1);
    animation: ringExpand 2.5s ease-out infinite 1.6s;
  }

  @keyframes ringExpand {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.8;
    }
    100% {
      transform: translate(-50%, -50%) scale(1.8);
      opacity: 0;
    }
  }

  /* ===== Glitch Text ===== */
  .loader-text {
    text-align: center;
  }

  .text-ninja {
    position: relative;
    font-size: clamp(2.5rem, 8vw, 4rem);
    font-weight: 900;
    letter-spacing: 0.3em;
    color: white;
    text-shadow: 0 0 40px rgba(255, 255, 255, 0.1);
  }

  .char {
    display: inline-block;
    opacity: 0;
    transform: translateY(30px) rotateX(-90deg);
    animation: charReveal 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: calc(var(--i) * 0.08s + 0.3s);
  }

  @keyframes charReveal {
    to {
      opacity: 1;
      transform: translateY(0) rotateX(0);
    }
  }

  .text-ninja::before,
  .text-ninja::after {
    content: attr(data-text);
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    letter-spacing: 0.3em;
  }

  .text-ninja::before {
    color: #00f5ff;
    animation: glitch1 4s infinite;
    clip-path: polygon(0 0, 100% 0, 100% 35%, 0 35%);
    opacity: 0.8;
  }

  .text-ninja::after {
    color: #ff006e;
    animation: glitch2 4s infinite;
    clip-path: polygon(0 65%, 100% 65%, 100% 100%, 0 100%);
    opacity: 0.8;
  }

  @keyframes glitch1 {
    0%, 85%, 100% { transform: translate(0); opacity: 0; }
    86% { transform: translate(-4px, 2px); opacity: 0.8; }
    88% { transform: translate(4px, -2px); opacity: 0.8; }
    90% { transform: translate(-2px, 1px); opacity: 0.8; }
    92% { transform: translate(2px, -1px); opacity: 0.8; }
    94% { transform: translate(0); opacity: 0; }
  }

  @keyframes glitch2 {
    0%, 85%, 100% { transform: translate(0); opacity: 0; }
    87% { transform: translate(4px, -2px); opacity: 0.8; }
    89% { transform: translate(-4px, 2px); opacity: 0.8; }
    91% { transform: translate(2px, -1px); opacity: 0.8; }
    93% { transform: translate(-2px, 1px); opacity: 0.8; }
    95% { transform: translate(0); opacity: 0; }
  }

  .text-studio {
    font-size: 0.8rem;
    font-weight: 500;
    letter-spacing: 0.5em;
    color: rgba(255, 255, 255, 0.35);
    margin-top: 0.75rem;
    opacity: 0;
    animation: fadeSlideIn 0.6s ease forwards 0.8s;
  }

  @keyframes fadeSlideIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* ===== Loading Status ===== */
  .loader-status {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    opacity: 0;
    animation: fadeSlideIn 0.5s ease forwards 1s;
  }

  .status-line {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .status-dot {
    width: 6px;
    height: 6px;
    background: #00f5ff;
    border-radius: 50%;
    animation: dotPulse 1s ease-in-out infinite;
  }

  @keyframes dotPulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(0.8); }
  }

  .status-text {
    font-family: var(--font-mono, 'Space Mono', monospace);
    font-size: 0.65rem;
    letter-spacing: 0.25em;
    color: rgba(255, 255, 255, 0.4);
    transition: all 0.3s ease;
  }

  .status-progress {
    display: flex;
    align-items: baseline;
    gap: 0.125rem;
  }

  .status-percent {
    font-family: var(--font-mono, 'Space Mono', monospace);
    font-size: 1.75rem;
    font-weight: 700;
    background: linear-gradient(135deg, #ff006e 0%, #bf00ff 50%, #00f5ff 100%);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: gradientShift 3s ease infinite;
    min-width: 3ch;
    text-align: right;
  }

  @keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }

  .status-symbol {
    font-family: var(--font-mono, 'Space Mono', monospace);
    font-size: 0.875rem;
    color: rgba(255, 255, 255, 0.4);
  }

  /* ===== Slice Reveal Exit ===== */
  .slice-reveal {
    position: absolute;
    inset: 0;
    z-index: 100;
    pointer-events: none;
    display: flex;
    flex-direction: column;
  }

  .slice {
    flex: 1;
    background: linear-gradient(90deg, #030305 0%, #050508 50%, #030305 100%);
    transform: scaleX(0);
  }

  .slice-1 { transform-origin: left; }
  .slice-2 { transform-origin: right; }
  .slice-3 { transform-origin: left; }
  .slice-4 { transform-origin: right; }
  .slice-5 { transform-origin: left; }

  /* ===== Exit Animation ===== */
  .ninja-loader.exit .loader-content {
    animation: contentExit 0.5s cubic-bezier(0.4, 0, 1, 1) forwards;
  }

  @keyframes contentExit {
    to {
      opacity: 0;
      transform: scale(0.9);
      filter: blur(20px);
    }
  }

  .ninja-loader.exit .slice-1 {
    animation: sliceIn 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.15s,
               sliceOut 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.45s;
  }
  .ninja-loader.exit .slice-2 {
    animation: sliceIn 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.19s,
               sliceOut 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.49s;
  }
  .ninja-loader.exit .slice-3 {
    animation: sliceIn 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.23s,
               sliceOut 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.53s;
  }
  .ninja-loader.exit .slice-4 {
    animation: sliceIn 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.27s,
               sliceOut 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.57s;
  }
  .ninja-loader.exit .slice-5 {
    animation: sliceIn 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.31s,
               sliceOut 0.12s cubic-bezier(0.4, 0, 0.2, 1) forwards 0.61s;
  }

  @keyframes sliceIn {
    to { transform: scaleX(1); }
  }

  @keyframes sliceOut {
    from { transform: scaleX(1); }
    to { transform: scaleX(0); }
  }

  .ninja-loader.exit .loader-bg {
    animation: bgExit 0.4s ease forwards 0.7s;
  }

  @keyframes bgExit {
    to { opacity: 0; }
  }

  .ninja-loader.hidden {
    display: none;
  }

  /* ===== Reduced Motion ===== */
  @media (prefers-reduced-motion: reduce) {
    .shuriken-body,
    .inner-spin,
    .bg-grid,
    .energy-ring,
    .particle,
    .core-glow,
    .core-inner,
    .glow-ring {
      animation: none;
    }

    .char {
      opacity: 1;
      transform: none;
      animation: none;
    }

    .text-ninja::before,
    .text-ninja::after {
      display: none;
    }

    .ninja-loader.exit {
      animation: simpleFade 0.5s ease forwards;
    }

    .ninja-loader.exit .slice,
    .ninja-loader.exit .loader-content,
    .ninja-loader.exit .loader-bg {
      animation: none;
    }

    @keyframes simpleFade {
      to { opacity: 0; visibility: hidden; }
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const loader = document.getElementById('pageLoader');
    const progressCircle = document.getElementById('progressCircle');
    const percentText = document.getElementById('loaderPercent');
    const statusText = document.getElementById('statusText');
    const particlesContainer = document.getElementById('particles');

    if (!loader) return;

    // Create particles
    const particleCount = 30;
    for (let i = 0; i < particleCount; i++) {
      const particle = document.createElement('div');
      particle.className = 'particle';

      const size = 2 + Math.random() * 4;
      const isAccent = Math.random() > 0.5;

      particle.style.cssText = `
        left: ${Math.random() * 100}%;
        bottom: -20px;
        width: ${size}px;
        height: ${size}px;
        background: ${isAccent ? '#00f5ff' : '#ff006e'};
        box-shadow: 0 0 ${size * 2}px ${isAccent ? 'rgba(0, 245, 255, 0.5)' : 'rgba(255, 0, 110, 0.5)'};
        animation-delay: ${Math.random() * 4}s;
        animation-duration: ${4 + Math.random() * 3}s;
      `;
      particlesContainer?.appendChild(particle);
    }

    // Progress tracking
    const circumference = 2 * Math.PI * 88;
    let currentPercent = 0;
    const startTime = Date.now();
    const minDisplayTime = 2800;

    // Status messages
    const statusMessages = [
      { threshold: 0, text: 'INITIALIZING' },
      { threshold: 15, text: 'LOADING ASSETS' },
      { threshold: 35, text: 'PREPARING' },
      { threshold: 55, text: 'OPTIMIZING' },
      { threshold: 75, text: 'RENDERING' },
      { threshold: 90, text: 'FINALIZING' },
      { threshold: 100, text: 'COMPLETE' }
    ];

    function updateStatus(percent: number) {
      if (!statusText) return;

      const status = [...statusMessages]
        .reverse()
        .find(s => percent >= s.threshold);

      if (status && statusText.textContent !== status.text) {
        statusText.style.opacity = '0';
        setTimeout(() => {
          statusText.textContent = status.text;
          statusText.style.opacity = '1';
        }, 150);
      }
    }

    function updateProgress(targetPercent: number) {
      // Animate the number counting
      const animateCount = () => {
        if (currentPercent < targetPercent) {
          currentPercent = Math.min(currentPercent + 1, targetPercent);

          if (percentText) {
            percentText.textContent = String(Math.round(currentPercent));
          }

          if (progressCircle) {
            const offset = circumference - (currentPercent / 100) * circumference;
            progressCircle.style.strokeDashoffset = String(offset);
          }

          updateStatus(currentPercent);

          if (currentPercent < targetPercent) {
            requestAnimationFrame(animateCount);
          }
        }
      };

      animateCount();
    }

    // Smooth progress simulation with realistic curve
    let progress = 0;
    const progressSteps = [
      { target: 20, duration: 400 },
      { target: 45, duration: 500 },
      { target: 65, duration: 400 },
      { target: 80, duration: 300 },
      { target: 92, duration: 600 }
    ];

    let stepIndex = 0;

    function runProgressStep() {
      if (stepIndex >= progressSteps.length) return;

      const step = progressSteps[stepIndex];
      updateProgress(step.target);
      progress = step.target;
      stepIndex++;

      if (stepIndex < progressSteps.length) {
        setTimeout(runProgressStep, step.duration);
      }
    }

    // Start progress animation
    setTimeout(runProgressStep, 300);

    // Hide loader
    function hideLoader() {
      updateProgress(100);

      const elapsed = Date.now() - startTime;
      const remainingTime = Math.max(0, minDisplayTime - elapsed);

      setTimeout(() => {
        loader.classList.add('exit');

        setTimeout(() => {
          loader.classList.add('hidden');
          document.body.classList.remove('loading');
        }, 900);
      }, remainingTime + 300);
    }

    window.addEventListener('load', hideLoader);

    // Fallback
    setTimeout(hideLoader, 7000);
  });
</script>
